function DependencySet(){this.elements=[],this.add=function(a){for(var b=0;b<this.elements.length;++b)if(this.elements[b].equals(a))return;this.elements.push(a)},this.addAll=function(a){for(var b=0;b<a.elements.length;++b)this.add(new FunctionalDependency(a.elements[b].lhs.copy(),a.elements[b].rhs.copy()))},this.remove=function(a){for(var b=0;b<this.elements.length;++b)if(this.elements[b].equals(a))return void this.elements.splice(b,1)},this.removeRedundantLeftHandAttributes=function(a){for(var b=0;b<a.copy().elements.length;++b){var c=a.elements[b];if(c.lhs.length>1)for(var d=c.lhs.copy(),e=0;e<d.length;++e){var f=d[e],g=c.lhs.copy();g.remove(f);var h=new FunctionalDependency(g,c.rhs),i=a.copy();if(i.remove(c),i.add(h),i.equals(a))return a.remove(c),a.add(h),console.log("REPLACE: "+c+" with "+h.lhs+"->"+h.rhs),1}}return 0},this.minCover=function(a){for(var b=null,c=new DependencySet,d=0;d<this.elements.length;++d){var e=this.elements[d];if(e.isTrivial());else if(1==e.rhs.length)c.add(new FunctionalDependency(e.lhs,e.rhs));else for(var f=0;f<e.rhs.length;++f){var g=e.rhs,h=new FunctionalDependency(e.lhs,g.copy());h.isTrivial()||c.add(h)}}for(b=c,a&&(a.singleRightHandSides=c);this.removeRedundantLeftHandAttributes(b)>0;);for(var i=0;i<b.copy().elements.length;++i){var j=b.copy().elements[i];b.remove(j),j.lhs.closure(b).containsAll(j.rhs)||b.add(j)}var k=b;return k},this.attributeSet=function(){for(var a=[],b=0;b<this.elements.length;++b)a=a.concat(this.elements[b].lhs.set()),a=a.concat(this.elements[b].rhs.set());return a.set()},this.copy=function(){var a=new DependencySet;return a.addAll(this),a},this.isEmpty=function(){return 0===this.elements.length},this.equals=function(a){for(var b=0;b<this.elements.length;++b){var c=this.elements[b],d=c.lhs.closure(a);if(!d.containsAll(c.rhs))return!1}for(var e=0;e<this.elements.length;++e){var f=this.elements[e],g=f.lhs.closure(this);if(!g.containsAll(f.rhs))return!1}return!0},this.clear=function(){this.elements=[]},this.print=function(){for(var a=0;a<this.elements.length;++a)this.elements[a].print()}}function FunctionalDependency(a,b){this.lhs=a.copy(),this.rhs=b.copy(),this.getAttributeSet=function(){var c=a.concat(b);return c.sort().filter(function(a,b){return!b||a!=c[b-1]})},this.isTrivial=function(){return 0===b.length?!0:a.containsAll(b)},this.equals=function(a){if(this.lhs.length!==a.lhs.length||this.rhs.length!==a.rhs.length)return!1;for(var b=0;b<this.lhs.length;++b)if(this.lhs[b]!=a.lhs[b])return!1;for(var c=0;c<this.rhs.length;++c)if(this.rhs[c]!=a.rhs[c])return!1;return!0},this.toString=function(){return this.lhs+" â†’ "+this.rhs},this.print=function(){console.log(this)}}Array.prototype.set=function(){var a=this;return this.sort().filter(function(b,c){return!c||b!=a[c-1]})},Array.prototype.containsAll=function(a){for(var b=[],c=0;c<a.length;++c)this.indexOf(a[c])>-1&&b.push(a[c]);return b.length===a.length},Array.prototype.copy=function(){return this.slice()},Array.prototype.equals=function(a){if(!a)return!1;if(this.length!=a.length)return!1;for(var b=0,c=this.length;c>b;b++)if(this[b]instanceof Array&&a[b]instanceof Array){if(!this[b].equals(a[b]))return!1}else if(this[b]!=a[b])return!1;return!0},Array.prototype.isEmpty=function(){return 0===this.length},Array.prototype.remove=function(a){var b=this.indexOf(a);b>-1&&this.splice(b,1)},Array.prototype.closure=function(a){for(var b=[],c=this.copy();!c.equals(b);){b=c.copy(),c=c.copy();for(var d=0;d<a.elements.length;++d){var e=a.elements[d];c.containsAll(e.lhs)&&(c=c.concat(e.rhs).set())}}return c};var parseInput=function(a){a=a.split("\n");for(var b=new DependencySet,c=0;c<a.length;++c){var d=a[c],e=d.indexOf("->");if(e>=0){for(var f=d.substring(0,e).trim().split(","),g=d.substring(e+2,d.length).trim().split(","),h=0;h<f.length;++h)f[h]=f[h].trim();for(var i=0;i<g.length;++i)g[i]=g[i].trim();if(f.length>0&&g.length>0){var j=new FunctionalDependency(f,g);b.add(j)}}}return b};angular.module("dbNormalizer",[]).controller("appController",["$scope",function(b){b.rawInput="SSN -> Salary\nSSN -> Phone\nSSN -> Dno\nPno -> Pname\nPno -> Plocation\nSSN,Pno -> Salary\nSSN,Pno -> Phone\nSSN,Pno -> Dno\nSSN,Pno -> Pname\nSSN,Pno -> Plocation",b.functionalDependencies=null,b.minCover=null,b.singleRightHandSides=null,b.normalize=function(){var c=b.rawInput;for(b.functionalDependencies=parseInput(c);b.functionalDependencies.removeRedundantLeftHandAttributes(b.functionalDependencies)>0;);b.minCover=b.functionalDependencies.minCover(b);for(var d=b.minCover.copy(),e=new DependencySet;!d.isEmpty();){var f=d.elements[0];d.remove(f),b.minCover.remove(f),e.add(f);for(var g=0;g<d.elements.length;++g){var h=d.elements[g];f.lhs.equals(h.lhs)&&(f.rhs=f.rhs.concat(h.rhs),b.minCover.remove(h))}d=b.minCover.copy()}b.minCover=e,console.log(minCover);var i=functionalDependencies.attributeSet(),j=findCandidateKey(minCover);alert(j);var k=i.allCandidateKeys(minCover);if(null!==k)for(var l=0;l<k.elements.length;++l){var m=k.elements[l];alert(m)}for(var n=[],o=0;5>o;++o){var p=b.minCover.elements,q=new Relation(p);n.add(q)}for(var r=minCover.getAllAttributes(),s=[],t=0;t<i.length;++t){if(r.contains(a)||s.add(a),!s.isEmpty()){var u=new Relation(s,s);n.add(u)}for(var v=0;v<n.length;++v){var w=n[v];alert(w)}}for(var x=[],y=0;y<b.minCover.elements.length;++y){var z=minCover.elements[y],A=new Relation(z);x.add(A)}for(var B=!1,C=0;C<x.length;++C){var D=x[C],E=D.getAttributes();if(E.containsAll(j)){B=!0;break}}B||x.add(new Relation(j,j));for(var F=null;null!==(F=findRedundantTable(x));)x.remove(F);for(var G=0;G<x.length;++G){x[G]}}}]);